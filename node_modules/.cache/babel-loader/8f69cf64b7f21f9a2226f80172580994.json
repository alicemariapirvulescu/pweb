{"ast":null,"code":"import \"core-js/modules/es.promise.js\";\nimport { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport axios from 'axios';\nexport const loginUser = createAsyncThunk('auth/loginUser', async payload => {\n  try {\n    const response = await axios.post('http://localhost:8080/api/login', payload);\n    console.log(response.status);\n    return response.data;\n  } catch (err) {\n    console.log(\"Login failed\");\n    throw err;\n  }\n});\nexport const registerUser = createAsyncThunk('auth/registerUser', async payload => {\n  const response = await axios.get('http://127.0.0.1:5500/apps/mocks/login.json');\n  return response.status;\n});\nexport const getRestaurants = createAsyncThunk('auth/getRestaurants', async () => {\n  const response = await axios.get('http://127.0.0.1:5500/apps/mocks/restaurants.json');\n  console.log(\"Get restaurants was called\");\n  return response.data;\n});\nexport const getReviews = createAsyncThunk('auth/getReviews', async id => {\n  const response = await axios.get('http://127.0.0.1:5500/apps/mocks/reviews.json');\n  console.log(\"Get reviews was called\" + id);\n  return response.data;\n});\nexport const getRestaurant = createAsyncThunk('auth/getRestaurant', async id => {\n  console.log(\"Get restaurant was called with params: \" + id);\n  const response = await axios.get('http://127.0.0.1:5500/apps/mocks/restaurant.json');\n  console.log(response.data);\n  return response.data;\n});\nconst initialState = {\n  restaurants: [],\n  restaurant: {},\n  isLoggedIn: true,\n  user: {},\n  reviews: [],\n  review: {},\n  toastError: '',\n  toastSuccess: ''\n}; // Then, handle actions in your reducers:\n\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout(state) {\n      console.log('logging out');\n      state.isLoggedIn = false;\n      sessionStorage.removeItem(\"token\");\n    },\n\n    setToastSuccess(state, action) {\n      state.toastSuccess = action.payload;\n      let n;\n      n = window.setTimeout(() => {\n        state.toastSuccess = '';\n      }, 3000);\n      clearTimeout(n);\n    },\n\n    setToastError(state, action) {\n      state.toastError = action.payload;\n      let n;\n      n = window.setTimeout(() => {\n        state.toastError = '';\n      }, 3000);\n      clearTimeout(n);\n    }\n\n  },\n  // standard reducer logic, with auto-generated action types per reducer\n  extraReducers: builder => {\n    // Add reducers for additional action types here, and handle loading state as needed\n    builder.addCase(getRestaurants.fulfilled, (state, response) => {\n      // Add restaurants to the slice array\n      state.restaurants = response.payload;\n      console.log(state.restaurants);\n    });\n    builder.addCase(loginUser.fulfilled, (state, response) => {\n      // Set is Logged in to true\n      state.isLoggedIn = true;\n      state.user = response.payload;\n    });\n    builder.addCase(loginUser.rejected, state => {\n      // Set is Logged in to true\n      state.isLoggedIn = false;\n    });\n    builder.addCase(getRestaurant.fulfilled, (state, response) => {\n      // Add restaurants to the slice array\n      state.restaurant = response.payload;\n      state.review = response.payload.review;\n      authSlice.caseReducers.setToastSuccess(state, {\n        payload: 'Login successful!',\n        type: 'toast'\n      });\n      console.log(state.restaurant);\n    });\n    builder.addCase(getReviews.fulfilled, (state, response) => {\n      // Add restaurants to the slice array\n      state.reviews = response.payload;\n      authSlice.caseReducers.setToastError(state, {\n        payload: 'Login failed! Wrong credentials',\n        type: 'toast'\n      });\n      console.log(state.reviews);\n    });\n  }\n});","map":null,"metadata":{},"sourceType":"module"}